# 网络基础

### 网络架构

**网络架构分三层**（为了快速排查网络中出现的问题）：

- 接入层

  同一局域网下通信

- 汇聚层

  不同局域网下通信

- 核心层

  访问外网

**现阶段网络中几个要点**：

- 优化，路线最优

- 可靠，避免单点故障

- 安全，纵深防御

  流行的网络安全架构，纵深防御：防火墙->IPS->WAF

- 统一，方便管理

**两大功能**：路由和交换

**下一代企业网络肯定得上云，可以避免资源浪费，减少服务器运维压力。**

---

### 网络模型

**OSI七层**：

- 上三层：应用层、表示层（处理数据格式数据加密）、会话层（建立维护管理会话）
- 下四层：传输层、网络层、数据链路层、物理层

由上到下封装，由下到上解封装。路由时路由器解封装到网络层就够了，只需要知道到达目标的下一跳的地址。

**TCP/IP五层**：常见的网络协议都是基于TCP/IP五层模型的。

- 应、表、会-->合并为应用层

- 应用层：提供应用程序网络接口

- 传输层：建立端到端连接

  上边需要有端口号，下边没有端口号。

- 网络层：寻址和路由选择

- 数据链路层：物理介质访问

- **对于网络层的IPV4安全隐患**
  - 缺乏数据源验证
  - 缺乏完整性验证机制
  - 缺乏机密性保障机制

**被动攻击**

​		监听，窃取

**主动攻击**

​		假冒伪装，篡改，拒绝服务

**中间人攻击**

​		AB通信流量都经过C，C可以对流量做一些事情。

---

### VLAN原理和配置

VLAN，虚拟局域网技术，（用于二层）交换机

通过划分不同VLAN隔离广播域

**链路类型**

​		接入终端的链路为Access，Access端口在收到数据后会添加VLAN Tag，转发数据前会移除VLAN Tag。进打出剥。

​		交换机之间链路为Trunk，收到不带标签的数据帧会添加端口的PVID（默认1），发送帧时，检查该帧的VLANID在Trunk的允许发送列表中：若与端口的PVID相同时，则剥离Tag发送；若与端口的PVID不同时，则直接发送。

**配置VLAN**

​		创建VLAN-->修改端口类型-->设置端口允许通过VLAN ID

---

### 网络编址

**网段中主机有三个IP不能用**：

- 192.168.1.0代表整个网段

- 192.168.1.255代表广播地址

- 网段中第一个可用地址192.168.1.1或最后一个可用地址192.168.1.254一般做网关，可以自定义。

**私有地址范围**：

- 10.0.0.0~10.255.255.255
- 172.16.0.0~172.31.255.255
- 192.168.0.0~192.168.255.255

**特殊地址**：

- 127.0.0.0~127.255.255.255
- 0.0.0.0
- 255.255.255.255

**掩码聚合（CIDR）**

- 偶聚奇不聚，聚合时注意被舍弃的对子网有效的位数变化是否都在被聚合。

---

### 网络路由基础

三层非直连 不同局域网通信时需要路由器，路由器基于路由表工作。

**最优路由选择**：

1. 路由表中，优先级preference越小越优先。
2. 优先级一样看开销cost，走开销小的。
3. 开销也一样，负载分担。

---

### 静态路由基础

静态路由是指由管理员手动配置和维护的路由。

**缺省路由**

​		目的地址和掩码全都为0的特殊路由，代表所有。

​		如果报文的目的地址无法匹配路由表中的任何一项，路由器将选择依照缺省路由来转发报文。

​		两直连路由器不能都配缺省路由。

**下一跳**

​		下个路由器的进口IP



网络通信是相互的，两端通信路由都得配。